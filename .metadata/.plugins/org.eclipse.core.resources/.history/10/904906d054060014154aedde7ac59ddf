package com.controlador;
import java.io.IOException;

import javax.servlet.http.*;

import com.modelo.DataStoreConection;


@SuppressWarnings("serial")
public class CSNnewsServlet extends HttpServlet {
	/* Este servlet validará los correos de las cuentas de usuario registradas
	 * al cual accederan por un enlace que se envia a los correos 
	 * en el cual estan predefinidas las variables por GET: correo, user, cod y validate
	 * http://dominio.com/csnews?user=...&correo=...&cod=...&validate=true 
	 * */
	
	public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {
		/*Recibe las variables de validación por GET y edita el datastore con su 
		 * función predefinida validar_cuenta(correo, codigo_validacion), cambiando
		 * el valor predefinido del atributo validado en la entidad usuario de 0 a 1 
		 * */
		//String username = req.getParameter("user");
		//String validate = req.getParameter("validate");		
		String correo = req.getParameter("correo");
		String codigo_validacion = req.getParameter("cod");		
			
		DataStoreConection ds = new DataStoreConection();
		if(ds.validar_cuenta(correo, codigo_validacion)){
			resp.sendRedirect("notificaciones.jsp?m=cuenta_validada ");
		}else{
			resp.sendRedirect("notificaciones.jsp?m=datos_erroneos;correo="+correo+";codigo="+codigo_validacion);
		}		
	}
}
